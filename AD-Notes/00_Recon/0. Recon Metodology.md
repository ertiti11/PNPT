# 🧭 Metodología de Enumeración en Pentesting AD

Este documento sirve como guía paso a paso para la enumeración en entornos Windows / Active Directory.  
Incluye fases, objetivos, comandos y herramientas alternativas.

---

## 1️⃣ Reconocimiento inicial

### Descubrimiento de hosts

```bash
nmap -sn 10.10.10.0/24
fping -a -g 10.10.10.0/24 2>/dev/null
```


```bash
nmap -p- --min-rate 10000 -T4 -oA fullscan 10.10.10.100
```



### Escaneo de puertos

```bash
nmap -sCV -p- --open --min-rate 5000  -oA fullscan 10.10.10.100 -v
incursore -h 10.10.10.100 -t all
```



## 2️⃣ Enumeración de SMB

### Shares disponibles

```bash
smbclient -L //10.10.10.100 -N 
smbmap -H 10.10.10.100
crackmapexec smb 10.10.10.100 -u '' -p '' --shares
enum4linux -h 10.10.10.100
```
### Conexión a un share

```bash
smbclient //10.10.10.100/Users -U "dominio\usuario%contraseña"
```

### Herramientas automáticas

```bash
enum4linux-ng -A 10.10.10.100
```

## 3️⃣ Enumeración RPC

### Conexión anónima

```bash
rpcclient -U "" -N 10.10.10.100
```

### Comandos importantes de rpcclient

```bash
enumdomusers
enumdomgroups
queryuser <RID> 
getdompwinfo
```

## 4️⃣ Enumeración LDAP

### Usuarios activos

```bash
ldapsearch -x -H ldap://10.10.10.100 \   -D "usuario@dominio" -w 'contraseña' \   -b "dc=dominio,dc=local" \   "(&(objectCategory=person)(objectClass=user)(!(useraccountcontrol:1.2.840.113556.1.4.803:=2)))" sAMAccountName
```
### SPNs para Kerberoasting

`ldapsearch -x -H ldap://10.10.10.100 \   -D "usuario@dominio" -w 'contraseña' \   -b "dc=dominio,dc=local" "(servicePrincipalName=*)" servicePrincipalName`